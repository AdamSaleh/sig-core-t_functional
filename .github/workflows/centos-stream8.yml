jobs:
  test_c8s:
    name: test_c8s
    runs-on: ubuntu-latest
    environment: centosduffy
    steps:
      - name: Install SSH key
        uses: shimataro/ssh-key-action@v2
        with:
          key: ${{ secrets.DUFFYY_SSH_PRIVATE_KEY }}
          name: id_centos_stream # optional
          known_hosts: NO 
          if_key_exists: replace # replace / ignore / fail; optional (defaults to fail)
      - uses: "actions/checkout@v2"
      - run: python3 t_functional_duffy_runner/src/__main__.py --arch=x86 --release=centos-9s --sshkey=/home/runner/.ssh/id_centos_stream
        env:
            DUFFY_AUTH_NAME: ${{ secrets.DUFFY_AUTH_NAME }}
            DUFFY_AUTH_KEY: ${{secrets.DUFFY_AUTH_KEY}}
  test_c9s:
    name: test_9s
    runs-on: ubuntu-latest
    environment: centosduffy
    steps:
      - name: Install SSH key
        uses: shimataro/ssh-key-action@v2
        with:
          key: ${{ secrets.DUFFYY_SSH_PRIVATE_KEY }}
          name: id_rsa # optional
          known_hosts: NO 
          if_key_exists: replace # replace / ignore / fail; optional (defaults to fail)
      - uses: "actions/checkout@v2"
      - run: python3 t_functional_duffy_runner/src/__main__.py --arch=x86 --release=centos-9s --sshkey=/home/runner/.ssh/id_centos_stream
        env:
            DUFFY_AUTH_NAME: ${{ secrets.DUFFY_AUTH_NAME }}
            DUFFY_AUTH_KEY: ${{secrets.DUFFY_AUTH_KEY}}

name: Testing
on:
 pull_request_target: 
    branches: [ master ]
